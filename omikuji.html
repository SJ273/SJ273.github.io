<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        .body {
            text-align: center;
        }
        #random {
            white-space: pre-line;
        }
    </style>
    <title>SJ273ã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ª - ãŠã¿ãã˜</title>
</head>
<body>
    <div class="body">
<h2>ä»Šæ—¥ã®ãŠã¿ãã˜</h2>
<button onclick="omikuji()">ãŠã¿ãã˜å¼•ã</button>

<p id="date"></p>
<p id="result"></p>
<p id="comment"></p>

<script>
const today = new Date();
const todayStr = today.toDateString();
const savedDay = localStorage.getItem("omikujiDay");
const savedResult = localStorage.getItem("omikujiResult");

if (savedDay === todayStr && savedResult) {
  showResult(savedResult);
}

function omikuji() {
  const savedDay = localStorage.getItem("omikujiDay");

  if (savedDay === todayStr) {
    document.getElementById("comment").textContent =
      "ä»Šæ—¥ã¯ã‚‚ã†å¼•ã„ã¦ã„ã¾ã™ã€‚ã¾ãŸæ˜æ—¥æ¥ã¦ãã ã•ã„ã€‚";
    return;
  }

  const r = Math.random() * 100;
  let result = "";

  if (r < 10) {
    result = "å¤§å‰";
  } else if (r < 30) {
    result = "ä¸­å‰";
  } else if (r < 60) {
    result = "å°å‰";
  } else if (r < 85) {
    result = "å‰";
  } else {
    result = "å‡¶";
  }

  localStorage.setItem("omikujiDay", todayStr);
  localStorage.setItem("omikujiResult", result);

  showResult(result);
}

function showResult(result) {
  document.getElementById("date").textContent =
    `æ—¥ä»˜ï¼š${today.getFullYear()}å¹´${today.getMonth()+1}æœˆ${today.getDate()}æ—¥`;

  document.getElementById("result").textContent =
    `ä»Šæ—¥ã®é‹å‹¢ã¯â€¦ã€Œ${result}ã€ï¼`;

  if (result === "å‡¶") {
    document.getElementById("comment").textContent =
      "ç„¡ç†ã›ãšæ…é‡ã«è¡Œå‹•ã—ã‚ˆã†ã€‚ä»Šæ—¥ã¯æº–å‚™ã®æ—¥ï¼";
  } else {
    document.getElementById("comment").textContent =
      "ã„ã„ä¸€æ—¥ã«ãªã‚Šãã†ã ã­ ğŸ‘";
  }
}
</script>
</body>
</html>
