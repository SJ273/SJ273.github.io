<!DOCTYPE html>
<html lang="ja">
<head>
<script type="text/javascript">
  if (document.referrer.indexOf('sj273.github.io') === -1) {
      window.location.href = 'https://sj273.github.io/redirect';                
  }
</script>
<meta charset="UTF-8">
<title>SJ273のポートフォリオ - 恐竜ゲーム</title>
<link rel="stylesheet" href="style.css">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<style>
html, body {
  margin: 0;
  padding: 0;
  background: #fff;
  touch-action: manipulation;
  font-family: sans-serif;
}

#container {
  display: flex;
  justify-content: center;
}

#game {
  width: 100%;
  max-width: 700px;
  height: 200px;
  background: #fff;
  border: 2px solid #000;
  position: relative;
  overflow: hidden;
}

.night {
  background: #222;
  color: #fff;
}

#ground {
  position: absolute;
  bottom: 0;
  width: 200%;
  height: 16px;
  background: url("地面.png") repeat-x;
}

#dino {
  width: 48px;
  height: 48px;
  position: absolute;
  left: 60px;
  bottom: 16px;
  background: url("pen1_80.gif")
              no-repeat center / contain;
}

.obstacle {
  position: absolute;
  bottom: 16px;
  width: 32px;
  background-image: url("サボテン.png");
  background-repeat: no-repeat;
  background-position: bottom center;
  background-size: 100% 100%;
}

.bird {
  width: 40px;
  height: 28px;
  bottom: 80px;
  background: url("鳥.png") no-repeat center / contain;
  animation: flap 0.4s infinite;
}

@keyframes flap {
  0%,100% { transform: translateY(0); }
  50% { transform: translateY(-6px); }
}

#score, #hiscore {
  position: absolute;
  top: 6px;
  font-size: 14px;
}

#score { right: 10px; }
#hiscore { left: 10px; }

.overlay {
  position: absolute;
  inset: 0;
  background: rgba(255,255,255,0.9);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  z-index: 10;
}

.night .overlay {
  background: rgba(0,0,0,0.85);
}

button {
  margin-top: 10px;
  padding: 10px 20px;
  font-size: 16px;
}
</style>
</head>
<body>
<h1 class="section-title" data-direction="left">DINOSOUR GAME</h1>
<div style="height: 1em;"></div>
スペースキー、マウスクリック、タップのどれかでジャンプします。
<div style="height: 6px;"></div>
音が流れるので音量注意。
<div style="height: 1em;"></div>
<div id="container">
  <div id="game">
    <div id="ground"></div>
    <div id="dino"></div>

    <div id="hiscore">0</div>
    <div id="score">0</div>

    <div id="title" class="overlay">
      <p>恐竜ゲーム</p>
      <button id="startBtn">スタート</button>
    </div>

    <div id="gameover" class="overlay" style="display:none">
      <p>ゲームオーバー</p>
      <button id="retryBtn">もう一度</button>
    </div>
  </div>
</div>
<div style="height: 2em;"></div>
Chromeの恐竜が走るゲームを再現してみた。名前が「恐竜ゲーム」なのはそういうこと。
<div style="height: 6px;"></div>
まあ走ってるのペンギンだけども。
<div style="height: 6px;"></div>
あとサボテンとか鳥の絵がめっちゃ雑なのは気にするな。
<div style="height: 2em;"></div>
<a href="/">ホームに戻る</a>
<h1 class="section-title" data-direction="right">DINOSOUR GAME</h1>
<font size="2">2025-2026 SJ273</font>
<div style="height: 2em;"></div>
<script src="marquee.js"></script>
<script>
const game = document.getElementById("game");
const dino = document.getElementById("dino");
const ground = document.getElementById("ground");
const scoreEl = document.getElementById("score");
const hiEl = document.getElementById("hiscore");
const title = document.getElementById("title");
const gameover = document.getElementById("gameover");

const jumpSE = new Audio("ニュッ2.mp3");
const overSE = new Audio("しょげる.mp3");
const scoreSE = new Audio("決定ボタンを押す17.mp3");

const preloadImages = [
  "pen1_80.gif",
  "pen1_12.gif",
  "サボテン.png",
  "鳥.png",
  "地面.png"
];

preloadImages.forEach(src => {
  const img = new Image();
  img.src = src;
});

let y = 0, vy = 0;
const gravity = -2200;
const jumpPower = 900;

let groundX = 0;
let speed = 300;
let score = 0;
scoreEl.textContent = "スコア：" + score;
let hiScore = localStorage.getItem("hi") || 0;
hiEl.textContent = "ハイスコア：" + hiScore;

let playing = false;
let obstacles = [];
let lastTime = null;
let spawnTimer = 0;

function hit(a, b, ma = 8, mb = 8) {
  const ar = a.getBoundingClientRect();
  const br = b.getBoundingClientRect();

  return !(
    ar.right - ma < br.left + mb ||
    ar.left + ma > br.right - mb ||
    ar.bottom - ma < br.top + mb ||
    ar.top + ma > br.bottom - mb
  );
}

function spawnObstacle() {
  const o = document.createElement("div");

  if (Math.random() < 0.25) {
    o.className = "obstacle bird";
  } else {
    o.className = "obstacle";
    o.style.height = (30 + Math.random() * 80) + "px";
  }

  o.style.left = "100%";
  game.appendChild(o);
  obstacles.push(o);
}

function loop(t) {
  if (!lastTime) lastTime = t;
  const dt = (t - lastTime) / 1000;
  lastTime = t;

  vy += gravity * dt;
  y += vy * dt;
  if (playing) {
    if (y < 0) { y = 0; vy = 0; }
  }
  dino.style.bottom = (y + 16) + "px";

  if (!playing && y <= -100) return;
  if (playing) {
  groundX -= speed * dt;
  ground.style.transform = `translateX(${groundX % 40}px)`;

  obstacles.forEach(o => {
    o.style.left = (o.offsetLeft - speed * dt) + "px";
    if (hit(dino, o, 10, o.classList.contains("bird") ? 12 : 6)) endGame();
  });

  obstacles = obstacles.filter(o => {
    if (o.offsetLeft < -60) {
      o.remove();
      score++;
      scoreEl.textContent = "スコア：" + score;

      if (score % 10 === 0) scoreSE.play();
      //if (score === 200) game.classList.add("night");

      speed += 10;
      return false;
    }
    return true;
  });

  spawnTimer += dt;
  if (spawnTimer > 1.4) {
    spawnObstacle();
    spawnTimer = 0;
  }
  }
  requestAnimationFrame(loop);
}

function jump() {
  if (!playing || y !== 0) return;
  vy = jumpPower;
  jumpSE.play();
}

game.addEventListener("pointerdown", e => {
  e.preventDefault();
  jump();
});

document.addEventListener("keydown", e => {
  if (e.code !== "Space") return;
  e.preventDefault();
  if (!playing) startGame();
  else jump();
});

function startGame() {
  title.style.display = "none";
  gameover.style.display = "none";
  game.classList.remove("night");

  obstacles.forEach(o => o.remove());
  obstacles = [];
  y = vy = 0;
  speed = 300;
  score = 0;
  scoreEl.textContent = "スコア：" + score;
  lastTime = null;
  playing = true;

  dino.style.backgroundImage =
    'url("pen1_80.gif")';

  requestAnimationFrame(loop);
}

function endGame() {
  playing = false;
  gameover.style.display = "flex";
  overSE.play();

  dino.style.backgroundImage =
    'url("pen1_55.gif")';

  vy = 900;
  
  if (score > hiScore) {
    hiScore = score;
    localStorage.setItem("hi", hiScore);
    hiEl.textContent = "ハイスコア：" + hiScore;
  }
}

document.getElementById("startBtn").onclick = startGame;
document.getElementById("retryBtn").onclick = startGame;
</script>

</body>
</html>


